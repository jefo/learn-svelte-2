# Виртуализация списка с бесконечной прокруткой

## Цели обучения

### Технические навыки
- [ ] Реализация виртуального скроллинга
- [ ] Работа с Intersection Observer API
- [ ] Оптимизация рендеринга больших списков
- [ ] Управление высотой и размерами элементов
- [ ] Обработка динамического контента

### Паттерны и практики
- [ ] Windowing (оконный рендеринг)
- [ ] Бесконечная прокрутка
- [ ] Кэширование видимых элементов
- [ ] Предзагрузка данных
- [ ] Оптимистичная загрузка UI

### Собеседование
- [ ] Объяснение принципов виртуализации
- [ ] Сравнение подходов к оптимизации списков
- [ ] Анализ производительности рендеринга
- [ ] Обсуждение браузерных API

## Задача

Создать компонент для отображения большого списка (10000+ элементов) с виртуализацией и бесконечной прокруткой. Акцент на плавности работы и эффективном использовании памяти.

## Требования

### Виртуализация (40%)
- [ ] Рендеринг только видимых элементов
- [ ] Динамический расчёт высоты
- [ ] Плавная прокрутка
- [ ] Правильная работа скроллбара

### Загрузка данных (30%)
- [ ] Бесконечная прокрутка
- [ ] Предзагрузка следующей страницы
- [ ] Индикация загрузки
- [ ] Обработка ошибок

### Оптимизация (30%)
- [ ] Переиспользование DOM элементов
- [ ] Кэширование размеров
- [ ] Дебаунс событий скролла
- [ ] Очистка неиспользуемых данных

## Типы данных
```typescript
interface ListItem {
    id: string;
    height?: number;  // Может быть динамическим
    content: string;
    // Дополнительные поля для демонстрации
    image?: string;
    timestamp: Date;
}

interface VirtualConfig {
    itemHeight: number;     // Базовая высота элемента
    overscan: number;       // Количество предзагружаемых элементов
    threshold: number;      // Порог для подгрузки новых данных
}
```

## Критерии оценки

### Производительность (50%)
- [ ] Прокрутка 60fps
- [ ] Память < 50MB при 10K элементов
- [ ] Время до первого рендера < 100ms
- [ ] Задержка при прокрутке < 16ms

### Функциональность (30%)
- [ ] Плавная прокрутка
- [ ] Корректная работа с разной высотой
- [ ] Сохранение позиции при обновлении
- [ ] Правильная работа с фокусом

### Код (20%)
- [ ] Переиспользуемый компонент
- [ ] Типы определены правильно
- [ ] Тесты производительности
- [ ] Понятная документация

## План работы

1. **Базовая виртуализация (День 1)**
   - Создать компонент-контейнер
   - Реализовать расчёт видимых элементов
   - Добавить базовый рендеринг

2. **Бесконечная прокрутка (День 2)**
   - Добавить Intersection Observer
   - Реализовать подгрузку данных
   - Оптимизировать обработку событий

3. **Оптимизация (День 3)**
   - Профилирование производительности
   - Оптимизация памяти
   - Улучшение UX

## Проверка знаний

### Теория
1. Как работает виртуализация списков?
2. Зачем нужен параметр overscan?
3. Как оптимизировать событие scroll?
4. Когда использовать fixed vs absolute позиционирование?

### Практика
1. Измерить производительность прокрутки
2. Оптимизировать память
3. Исправить проблемы с высотой
4. Улучшить UX загрузки

## Рекомендации

### Важно сделать
- Начать с простой реализации
- Измерять производительность
- Тестировать на реальных данных
- Проверять edge cases

### Не нужно делать
- Преждевременная оптимизация размеров
- Сложная анимация элементов
- Избыточное кэширование
- Сложная стилизация

## Частые ошибки
1. Неправильный расчёт высоты контейнера
2. Излишняя обработка событий скролла
3. Утечки памяти при очистке
4. Проблемы с фокусом элементов
